---
root_file: true

vars:
  backend_s3_bucket: "tfstate-3dda10e9-d16b-595f-bc60-e7efd8ced837"
  template_header: "// Code generated by tfgen. DO NOT EDIT."

template_files:
  _backend.tf: |
    {{ .template_header }}

    terraform {
      required_version = "1.1.9"

      required_providers {
        aws = {
          source  = "hashicorp/aws"
          version = "4.12.1"
        }
      }

      backend "s3" {
        bucket         = "{{ .backend_s3_bucket }}"
        dynamodb_table = "terraform-state-locking"
        encrypt        = true
        key            = "{{ .tfgen_working_dir }}/terraform.tfstate"
        region         = "us-east-1"
      }
    }

  _provider.tf: |
    {{ .template_header }}

    variable "allowed_account_id" {
      description = "AWS account identifier this code is permitted to run against."
      type        = string
    }

    provider "aws" {
      region              = "{{ .aws_region }}"
      allowed_account_ids = [var.allowed_account_id]
      default_tags {
        tags = {
          env    = "{{ .env }}"
          source = "github.com/vorotech/terraform-examples"
        }
      }
    }

    data "aws_default_tags" "this" {}

  _vars.tf: |
    {{ .template_header }}

    variable "env" {
      description = "Environment identifier."
      default     = "{{ .env }}"
      type        = string
    }
